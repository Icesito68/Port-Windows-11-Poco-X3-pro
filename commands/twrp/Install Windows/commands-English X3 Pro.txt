These commands have been tested and work perfectly

This process must be done after having done the commands in termux

Start TWRP recovery through the PC with the command
fastboot boot <twrp.img>

Don't copy lines with #

#####push partitioned script to sdcard######
adb push parted /sdcard/

####start adb shell#####
adb shell

#####move parted to sbin directory###
cp /sdcard/parted /sbin/ && chmod 755 /sbin/parted

#unmount data and sdcard
umount /data && umount /sdcard

#Start parted
parted /dev/block/sda


##### Repartitioning, WITH CAUSION #####
#First find the `userdata` partition by running the command
print all
# it will show you list of partitions with their name at the end of the line

# delete it with this command, ex: `rm 28`
rm {partition number}


#####Create partitions#########

#- Create partitions (128Gb models)

#Create the esp partition
mkpart esp fat32 11.8GB 12.2GB

#Create the windows partition
mkpart win ntfs 12.2GB 70.2GB

#Create the android data partition
mkpart userdata ext4 70.2GB 127GB



#- Create partitions (256Gb models)

#Create the esp partition
mkpart esp fat32 11.8GB 12.2GB

#Create the windows partition
mkpart win ntfs 12.2GB 132.2GB

#Create the android data partition
mkpart userdata ext4 132.2GB 255GB

#set the esp as bootable,
#use the command `print all`, to find the esp partition and get its partition number. ex: `set 28 esp on`
set {partition number} esp on

#Quit the parted
quit

#reboot to twrp

# start shell again

adb shell

#format the new partitions

#Format the esp partition as fat32
mkfs.fat -F32 -s1 /dev/block/by-name/esp

#Format the windows partition as ntfs
mkfs.ntfs -f /dev/block/by-name/win

#exit shell

Exit

#Format from wipe twrp by typing yes

#Check if Android starts

##with these commands your pc will be able to detect the mobile as a disk to carry out the installation (Have MTP disabled in Mount)

#Move msc.sh to internal memory
adb push msc.sh /sdcard

#start shell
adb shell

# indicate that we want to use the root
cd /sdcard

#These two commands start the program
chmod +x msc.sh

./msc.sh

###Once the X3 pro is detected as a disk###

# we open a cmd

#This will start the Windows Disk Management tool
diskpart

#Select the disk that is your x3 pro
sel disk 1 (or whatever your poco x3 pro is)

# Select the volume where we are going to install Windows
sel vol 3

# We assign the letter x to the volume where we are going to install Windows
assign letter=x

# Select the volume where we will install the drivers
sel vol 4

# We assign the letter and the volume where we will install the drivers
assign letter=y

#Install Windows 11 on the X3 Pro (replace "Usuario" with your username and "WindowsarmFolder" with your folder that contains windows arm, but no spaces)

dism /apply-image /ImageFile:"C:\Users\Usuario\Downloads\WindowsarmFolder\sources\install.wim" /index:1 /ApplyDir:X:\

#Install drivers (replace vayudriversfolder with the location of the drivers folder)(open in powershell as administrator)
.\driverupdater.exe -d (vayudriversfolder)\definitions\Desktop\ARM64\Internal\vayu.txt -r (vayudriversfolder) -p X:

#this is to select Y as uefi
bcdboot X:\Windows /s Y: /f UEFI

# Now unsigned drivers must be allowed
bcdedit /store Y:\EFI\Microsoft\BOOT\BCD /set {default} testsigning on

#This command is optional, it is to bring up a start menu
bcdedit /store Y:\EFI\Microsoft\BOOT\BCD /set {bootmgr} displaybootmenu yes

###############Boots with Windows bootable UEFI image##############

fastboot flash boot (device uefi.img)

